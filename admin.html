<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  font-family:Arial;
  background:#f5f6fa;
  margin:0;
  padding:20px;
}
.card{
  background:white;
  padding:15px;
  border-radius:10px;
  margin-bottom:15px;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
}
h2{margin-top:0}
.alerta{
  color:#c0392b;
  font-weight:bold;
}
.ok{
  color:#27ae60;
  font-weight:bold;
}
</style>
</head>

<body>

<h2>ðŸ“Š Dashboard HACCP</h2>

<div id="conteudo">A carregar...</div>

<script>

const CONFIG = {
  URL_SCRIPT: "https://script.google.com/macros/s/AKfycby5RmGeAWc4BhYsKLDsIgpBKpx_ZRgg2cwuB-viaQkJiI-d_pHmWJWcRQxm-RVPqrq7/exec"
};

async function carregar(){

  try{

    const response = await fetch(CONFIG.URL_SCRIPT,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify({ action:"getDashboardHACCP" })
    });

    const data = await response.json();

    if(!data || data.length==0){
      document.getElementById("conteudo").innerHTML="Sem registos";
      return;
    }

    let html="";

    data.forEach(r=>{

      const alertaTemp = (r.temperatura < 0 || r.temperatura > 5)
        ? "<span class='alerta'>âš  Fora do intervalo</span>"
        : "<span class='ok'>âœ” OK</span>";

      html += `
        <div class="card">
          <b>${r.equipamento}</b><br>
          Temp: ${r.temperatura}ÂºC ${alertaTemp}<br>
          FuncionÃ¡rio: ${r.funcionario}<br>
          Data: ${r.data}
        </div>
      `;
    });

    document.getElementById("conteudo").innerHTML = html;

  }catch(e){
    document.getElementById("conteudo").innerHTML="Erro ao carregar dados";
  }

}

carregar();
setInterval(carregar, 15000);

</script>

</body>
</html>

