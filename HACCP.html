<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body{
      font-family: Arial;
      padding:20px;
      background:#f5f5f5;
    }
    input,select,button{
      padding:10px;
      margin:5px 0;
      width:100%;
      border-radius:8px;
      border:1px solid #ccc;
    }
    button{
      background:#111;
      color:white;
      border:none;
      font-weight:bold;
      cursor:pointer;
    }
    table{
      width:100%;
      margin-top:20px;
      border-collapse:collapse;
      background:white;
    }
    th,td{
      padding:8px;
      border-bottom:1px solid #ddd;
      text-align:left;
    }
  </style>
</head>
<body>

<h2>Dashboard HACCP</h2>

<select id="equip">
  <option>Frigorífico</option>
  <option>Arca</option>
  <option>Congelador</option>
  <option>Vitrine</option>
</select>

<input id="temp" placeholder="Temperatura">
<input id="obs" placeholder="Observações">

<button onclick="gravar()">Guardar Registo</button>

<table id="tabela"></table>

<script>
function carregar(){
  google.script.run.withSuccessHandler(d=>{
    let html="<tr><th>Data</th><th>Equipamento</th><th>Temp</th><th>Obs</th></tr>";
    d.forEach((r,i)=>{
      if(i==0) return;
      html+=`<tr>
        <td>${r[0]}</td>
        <td>${r[1]}</td>
        <td>${r[2]}</td>
        <td>${r[3]}</td>
      </tr>`;
    });
    document.getElementById("tabela").innerHTML=html;
  }).getHaccp();
}

function gravar(){
  const dados={
    equipamento:document.getElementById("equip").value,
    temperatura:document.getElementById("temp").value,
    obs:document.getElementById("obs").value
  };

  google.script.run.withSuccessHandler(()=>{
    document.getElementById("temp").value="";
    document.getElementById("obs").value="";
    carregar();
  }).gravarHaccp(dados);
}

carregar();
</script>

</body>
</html>
